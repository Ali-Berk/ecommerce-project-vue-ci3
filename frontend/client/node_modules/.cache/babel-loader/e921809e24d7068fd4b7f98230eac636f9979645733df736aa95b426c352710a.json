{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport axios from \"axios\";\nimport { useRoute } from \"vue-router\";\nimport { useProductStore } from \"../store/ProductsStore\";\nexport default {\n  name: \"AdminEditProduct\",\n  data() {\n    return {\n      form: {\n        id: \"\",\n        title: \"\",\n        price: 0,\n        category_fk: \"\",\n        stock: 0,\n        description: \"\",\n        thumbnail: \"\"\n      },\n      categories: [],\n      files: [],\n      previews: [],\n      message: \"\",\n      messageType: \"alert-success\",\n      loading: false,\n      loaded: false\n    };\n  },\n  methods: {\n    async loadCategories() {\n      try {\n        const res = await axios.get(\"http://localhost:8080/api/get_categories\");\n        this.categories = Array.isArray(res.data) ? res.data : res.data.categories || [];\n      } catch (err) {\n        console.error(\"Kategori yüklenemedi:\", err);\n      }\n    },\n    async loadProduct() {\n      const route = useRoute();\n      const id = route.params.id;\n      try {\n        const res = await axios.get(`http://localhost:8080/api/get_product/${id}`);\n        const p = res.data.product;\n        this.form = {\n          id: p.product_id,\n          title: p.title,\n          price: p.price,\n          category_fk: p.category_fk,\n          stock: p.stock,\n          description: p.description,\n          thumbnail: p.thumbnail\n        };\n        this.loaded = true;\n      } catch (err) {\n        console.error(\"Ürün getirilemedi:\", err);\n        this.message = \"Ürün yüklenirken hata oluştu.\";\n        this.messageType = \"alert-danger\";\n      }\n    },\n    onFilesChange(e) {\n      const files = Array.from(e.target.files || []);\n      this.files = files;\n      this.previews = [];\n      files.forEach(file => {\n        const reader = new FileReader();\n        reader.onload = ev => this.previews.push(ev.target.result);\n        reader.readAsDataURL(file);\n      });\n    },\n    async updateProduct() {\n      this.loading = true;\n      this.message = \"\";\n      try {\n        const fd = new FormData();\n        fd.append(\"id\", this.form.id);\n        fd.append(\"title\", this.form.title);\n        fd.append(\"price\", this.form.price);\n        fd.append(\"category_fk\", this.form.category_fk);\n        fd.append(\"stock\", this.form.stock);\n        fd.append(\"description\", this.form.description);\n        fd.append(\"thumbnail\", this.form.thumbnail || \"\");\n        this.files.forEach(f => fd.append(\"images[]\", f, f.name));\n        const res = await axios.post(\"http://localhost:8080/api/update_product\", fd, {\n          headers: {\n            \"Content-Type\": \"multipart/form-data\"\n          },\n          withCredentials: true\n        });\n        if (res.data.status === \"success\") {\n          this.messageType = \"alert-success\";\n          this.message = \"Ürün başarıyla güncellendi.\";\n          try {\n            const store = useProductStore();\n            if (store && typeof store.loadCategory === \"function\") {\n              await store.loadCategory();\n            }\n          } catch {\n            err => console.log(err);\n          }\n        } else {\n          this.messageType = \"alert-danger\";\n          this.message = res.data.message || \"Güncelleme başarısız.\";\n        }\n      } catch (err) {\n        console.error(err);\n        this.messageType = \"alert-danger\";\n        this.message = \"Sunucu hatası oluştu.\";\n      } finally {\n        this.loading = false;\n      }\n    }\n  },\n  mounted() {\n    this.loadCategories();\n    this.loadProduct();\n  }\n};","map":{"version":3,"names":["axios","useRoute","useProductStore","name","data","form","id","title","price","category_fk","stock","description","thumbnail","categories","files","previews","message","messageType","loading","loaded","methods","loadCategories","res","get","Array","isArray","err","console","error","loadProduct","route","params","p","product","product_id","onFilesChange","e","from","target","forEach","file","reader","FileReader","onload","ev","push","result","readAsDataURL","updateProduct","fd","FormData","append","f","post","headers","withCredentials","status","store","loadCategory","log","mounted"],"sources":["/home/aliberk/Masaüstü/ecommerce/frontend/client/src/views/DashboardProductEditView.vue"],"sourcesContent":["<template>\n  <section class=\"container mt-4\">\n    <h3 class=\"mb-3\">Ürün Düzenle</h3>\n\n    <div v-if=\"message\" :class=\"`alert ${messageType}`\">{{ message }}</div>\n\n    <form v-if=\"loaded\" @submit.prevent=\"updateProduct\">\n      <div class=\"mb-3\">\n        <label class=\"form-label\">Başlık</label>\n        <input v-model=\"form.title\" type=\"text\" class=\"form-control\" required />\n      </div>\n\n      <div class=\"row\">\n        <div class=\"col-md-4 mb-3\">\n          <label class=\"form-label\">Fiyat (₺)</label>\n          <input v-model.number=\"form.price\" type=\"number\" step=\"0.01\" class=\"form-control\" required />\n        </div>\n\n        <div class=\"col-md-4 mb-3\">\n          <label class=\"form-label\">Kategori</label>\n          <select v-model=\"form.category_fk\" class=\"form-select\" required>\n            <option value=\"\">Seçin</option>\n            <option v-for=\"c in categories\" :key=\"c.category_id\" :value=\"c.category_id\">\n              {{ c.category_name }}\n            </option>\n          </select>\n        </div>\n\n        <div class=\"col-md-4 mb-3\">\n          <label class=\"form-label\">Stok Adedi</label>\n          <input v-model.number=\"form.stock\" type=\"number\" min=\"0\" class=\"form-control\" />\n        </div>\n      </div>\n\n      <div class=\"mb-3\">\n        <label class=\"form-label\">Açıklama</label>\n        <textarea v-model=\"form.description\" class=\"form-control\" rows=\"3\"></textarea>\n      </div>\n\n      <div class=\"mb-3\">\n        <label class=\"form-label\">Thumbnail (URL)</label>\n        <input v-model=\"form.thumbnail\" type=\"url\" class=\"form-control\" placeholder=\"https://...\" />\n        <img v-if=\"form.thumbnail\" :src=\"form.thumbnail\" class=\"mt-2 border rounded\" style=\"width:150px; height:100px; object-fit:cover;\">\n      </div>\n\n      <div class=\"mb-3\">\n        <label class=\"form-label\">Yeni Resimler (isteğe bağlı)</label>\n        <input ref=\"filesInput\" @change=\"onFilesChange\" type=\"file\" class=\"form-control\" multiple accept=\"image/*\" />\n      </div>\n\n      <div v-if=\"previews.length\" class=\"mb-3 d-flex gap-2 flex-wrap\">\n        <img v-for=\"(p, i) in previews\" :key=\"i\" :src=\"p\" class=\"border rounded\" style=\"width:100px;height:80px;object-fit:cover;\" />\n      </div>\n\n      <div class=\"d-flex gap-2\">\n        <button class=\"btn btn-primary\" type=\"submit\" :disabled=\"loading\">\n          {{ loading ? 'Güncelleniyor...' : 'Kaydet' }}\n        </button>\n        <router-link class=\"btn btn-secondary\" to=\"/dashboard/products\">Geri</router-link>\n      </div>\n    </form>\n\n    <p v-else class=\"text-muted\">Yükleniyor...</p>\n  </section>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport { useRoute } from \"vue-router\";\nimport { useProductStore } from \"../store/ProductsStore\";\n\nexport default {\n  name: \"AdminEditProduct\",\n  data() {\n    return {\n      form: {\n        id: \"\",\n        title: \"\",\n        price: 0,\n        category_fk: \"\",\n        stock: 0,\n        description: \"\",\n        thumbnail: \"\"\n      },\n      categories: [],\n      files: [],\n      previews: [],\n      message: \"\",\n      messageType: \"alert-success\",\n      loading: false,\n      loaded: false\n    };\n  },\n  methods: {\n    async loadCategories() {\n      try {\n        const res = await axios.get(\"http://localhost:8080/api/get_categories\");\n        this.categories = Array.isArray(res.data) ? res.data : res.data.categories || [];\n      } catch (err) {\n        console.error(\"Kategori yüklenemedi:\", err);\n      }\n    },\n    async loadProduct() {\n      const route = useRoute();\n      const id = route.params.id;\n      try {\n        const res = await axios.get(`http://localhost:8080/api/get_product/${id}`);\n        const p = res.data.product;\n        this.form = {\n          id: p.product_id,\n          title: p.title,\n          price: p.price,\n          category_fk: p.category_fk,\n          stock: p.stock,\n          description: p.description,\n          thumbnail: p.thumbnail\n        };\n        this.loaded = true;\n      } catch (err) {\n        console.error(\"Ürün getirilemedi:\", err);\n        this.message = \"Ürün yüklenirken hata oluştu.\";\n        this.messageType = \"alert-danger\";\n      }\n    },\n    onFilesChange(e) {\n      const files = Array.from(e.target.files || []);\n      this.files = files;\n      this.previews = [];\n      files.forEach(file => {\n        const reader = new FileReader();\n        reader.onload = ev => this.previews.push(ev.target.result);\n        reader.readAsDataURL(file);\n      });\n    },\n    async updateProduct() {\n      this.loading = true;\n      this.message = \"\";\n\n      try {\n        const fd = new FormData();\n        fd.append(\"id\", this.form.id);\n        fd.append(\"title\", this.form.title);\n        fd.append(\"price\", this.form.price);\n        fd.append(\"category_fk\", this.form.category_fk);\n        fd.append(\"stock\", this.form.stock);\n        fd.append(\"description\", this.form.description);\n        fd.append(\"thumbnail\", this.form.thumbnail || \"\");\n\n        this.files.forEach(f => fd.append(\"images[]\", f, f.name));\n\n        const res = await axios.post(\"http://localhost:8080/api/update_product\", fd, {\n          headers: { \"Content-Type\": \"multipart/form-data\" },\n          withCredentials: true\n        });\n\n        if (res.data.status === \"success\") {\n          this.messageType = \"alert-success\";\n          this.message = \"Ürün başarıyla güncellendi.\";\n          try {\n            const store = useProductStore();\n            if (store && typeof store.loadCategory === \"function\") {\n              await store.loadCategory();\n            }\n          } catch {err => console.log(err)}\n        } else {\n          this.messageType = \"alert-danger\";\n          this.message = res.data.message || \"Güncelleme başarısız.\";\n        }\n      } catch (err) {\n        console.error(err);\n        this.messageType = \"alert-danger\";\n        this.message = \"Sunucu hatası oluştu.\";\n      } finally {\n        this.loading = false;\n      }\n    }\n  },\n  mounted() {\n    this.loadCategories();\n    this.loadProduct();\n  }\n};\n</script>\n\n<style scoped>\n.preview-item {\n  display: inline-block;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}